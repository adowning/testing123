import{d as N,G as T,i as S,g as P,H as I,r as s,a as o,u as v,m,z as k,e as t,b as w,A as L,F as M,f as O,k as R,o as n,C as V,t as D,I as $,J as z}from"./index.03c1f994.js";import{s as G}from"./others.f78e1ae1.js";import{L as _}from"./index.d.a07b5bc4.js";const Z={class:"flex flex-col text-lg text-white bg-gray-900 pt-4 px-2 w-auto h-full relative"},K={key:0,class:"h-full flex flex-col justify-center"},W={key:1,class:"h-full flex flex-col"},Y=t("h2",null,"\u6635\u79F0\u767B\u5F55",-1),j=t("label",{for:"keyword"},null,-1),H={class:"mt-4 space-y-2 overflow-y-auto flex-1 pb-4 overflow-x-hidden"},J=["onClick"],q={alt:"\u5934\u50CF",class:"h-full"},Q={class:"ml-3 flex-1 transition-all"},X={class:"text-xl truncate"},ee={class:"text-sm text-gray-400 mt-1 overflow-elision-3"},te={key:0,class:"w-full text-center text-sm text-gray-400 my-4"},le=t("span",null,"\u52A0\u8F7D\u4E2D...",-1),se=[le],ae={key:1,class:"w-full text-center text-sm text-gray-400 my-4"},ce=N({__name:"index",setup(ue){T(()=>{i.state.loginType&&i.state.loginType!==-1&&E.replace("/")});const b=10,i=S(),E=P(),A=Number(I().params.type),p=s(""),x=s(!1),F=s(!1),y=s(0),r=s(-1),u=s(""),c=s(""),a=s([]),h=s(-1);function g(){!a.value.length||(i.commit("UPDATE_USERINFO",a.value[r.value]),i.commit("UPDATE_LOGINTYPE",h.value),i.dispatch("getLikelist"),E.replace("/library"))}async function U(){if(!u.value&&!c.value)return;h.value=_.ACCOUNT;const f=/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d{8}$/,e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(f.test(u.value)){const{data:d}=await $({phone:u.value,password:c.value});a.value.push(d.profile),r.value=0,g()}else if(e.test(u.value)){const{data:d}=await z({email:u.value,password:c.value});a.value.push(d.profile),r.value=0,g()}else console.log("\u65E0\u6548\u8D26\u53F7\u540D")}async function C(f=!1){if(!!p.value){f||(y.value=0,a.value=[]),x.value=!0;try{const{data:e}=await G({keywords:p.value,limit:b,offset:y.value,type:1002});e.result.userprofiles&&(a.value=a.value.concat(e.result.userprofiles),y.value+=b,F.value=e.result.hasMore)}catch(e){console.log(e)}finally{x.value=!1,h.value=_.USERNAME}}}return(f,e)=>{const d=R("img");return n(),o("div",Z,[v(A)===v(_).ACCOUNT?(n(),o("div",K,[m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),class:"w-full mt-4 px-4 py-2 rounded text-base font-medium text-black",type:"text",placeholder:"\u8F93\u5165\u90AE\u7BB1\u6216\u8005\u624B\u673A\u53F7"},null,512),[[k,u.value]]),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l),class:"w-full mt-4 px-4 py-2 rounded text-base font-medium text-black",type:"password",placeholder:"\u5BC6\u7801"},null,512),[[k,c.value]]),t("button",{class:"btn-primary mt-8",type:"button",onClick:U},"\u767B\u5F55")])):w("",!0),v(A)===v(_).USERNAME?(n(),o("div",W,[Y,t("fieldset",null,[j,m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),class:"w-full mt-4 px-4 py-2 rounded text-base font-medium text-black",type:"text",name:"username",id:"username",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u7F51\u6613\u4E91\u7528\u6237\u540D",onKeypress:e[3]||(e[3]=L(l=>C(),["enter"]))},null,544),[[k,p.value]])]),t("ul",H,[(n(!0),o(M,null,O(a.value,(l,B)=>(n(),o("li",{key:l.userId,class:V(["relative h-24 flex transition-all rounded-sm items-center self-start bg-opacity-30 duration-300",{"transform origin-left -translate-x-24":B===r.value}]),onClick:oe=>r.value=B},[m(t("img",q,null,512),[[d,l.avatarUrl]]),t("div",Q,[t("p",X,D(l.nickname),1),t("p",ee,D(l.signature),1)]),t("span",{class:"btn-primary absolute -right-20",onClick:g}," \u786E\u8BA4 ")],10,J))),128)),x.value?(n(),o("li",te,se)):F.value?(n(),o("li",ae,[t("span",{onClick:e[4]||(e[4]=l=>C(!0))},"\u52A0\u8F7D\u66F4\u591A")])):w("",!0)])])):w("",!0)])}}});export{ce as default};
